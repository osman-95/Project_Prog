# Object Detection using [Yolo v3](https://github.com/osman-95/TrainYourOwnYOLO)

## Folder structure
```
.
├── Content
|   ├── 1_Annotation
|   ├── 2_Training
|   ├── 3_inference
|   ├── Data
|   └── ...
├── Output
|   ├── images
|   └── video
└── Yolo.ipynb

```

The **Content file** contains all the necessary folder, packages and codes required for the implementation of the model
- It contains the image folder required for training and evaluation 
- Weights required to initiate the training 
- Scripts and instructions on annotating images
- Scripts and instructions on training your YOLOv3 model
- Utility scripts used by main scripts
- The configuration file of the model which is used to tune various parameters in the model like
   - The number of steps 
   - batch size
   - Training folder
   - learning rate
- The folder that saves checkpoints of the training
- Output folder that stores the results of the evalution

The **Output file** consists of a copy of the results obtained from the evaluation process. The results obtained is in the following format:
- image
- video

The **Yolo.ipynb** is the note book containing the complete code required to train an evalute the model.

## Description of the model

The pretrained model use was obtained from [AntonMu](https://github.com/AntonMu). The model was trained on a kitchen [dataset](Project_Prog/Project_tasks/Yolo_3/TrainYourOwnYOLO_AM/Data/Source_Images/Training_Images/) extracted from [indoor scene dataset](https://www.kaggle.com/itsahmad/indoor-scenes-cvpr-2019) from kaggle.The extracted dataset consisted of 300 images labelled with four labels
- oven
- kitchen sink
- refrigerator
- Range Hood

The data was labelled manually using [VoTT](https://github.com/microsoft/VoTT) software to label all the annotation of the images. The annotaion file generated by VoTT was in Pascal format (xml file) and was converted into Yolo format using the [xml to yolo formt converter](Project_Prog/Project_tasks/Yolo_3/TrainYourOwnYOLO_AM/1_Image_Annotation/Convert_to_YOLO_format.py ) code. This code convert the xml files to a csv list that is compatible with the pretrained yolo model. 

The data was trained with a pretrained [weights](Project_Prog/Project_tasks/Yolo_3/TrainYourOwnYOLO_AM/weights) to get better results and save training time. The weights were obtained from [Darknet](https://pjreddie.com/darknet/yolo/).

The data was trained for few hours until the loss value became very low and the results are shown below:
- [images](Project_Prog/Project_tasks/Yolo_3/TrainYourOwnYOLO_AM/Data/Source_Images/Test_Image_Detection_Results/)
- [video](Project_Prog/Project_tasks/Yolo_3/TrainYourOwnYOLO_AM/Data/Source_Images/Test_Image_Detection_Results/kvideo_catface.mp4)

sample outputs

 ![](https://raw.githubusercontent.com/osman-95/Project_Prog/master/Project_tasks/Yolo_3/TrainYourOwnYOLO_AM/Data/Source_Images/Test_Image_Detection_Results/VA-02-04-7657-02_l_catface.jpg)
    ![](https://raw.githubusercontent.com/osman-95/Project_Prog/master/Project_tasks/Yolo_3/TrainYourOwnYOLO_AM/Data/Source_Images/Test_Image_Detection_Results/N364080_catface.jpg)
    ![](https://raw.githubusercontent.com/osman-95/Project_Prog/master/Project_tasks/Yolo_3/TrainYourOwnYOLO_AM/Data/Source_Images/Test_Image_Detection_Results/N364071_catface.jpg)






